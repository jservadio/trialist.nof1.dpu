{
    "contents" : "wrap.norm <-\n  function(Pain, Fatigue, Drowsy, Sleep, Thinking, Constipation, Treat, score.range = c(30, 10, 10, 10, 10, 10),\n           Covs=NULL, model = \"normal\", var.model = \"hom\", nChains = 3, \n           conv.limit = 1.05, niters = 50000, nruns = 5000, setsize = 4000, \n           alphaprior, betaprior, varprior,varprior.params, path = \"\")\n  {\n    # Pain, Fatigue, Drowsy, Sleep, Thinking, Constipation are vectors of outcomes\n    # Treat is vector of treatment labels\n    # score.range is vector of upper limits of scores (with 0 as lower limit)\n    # Covs is matrix of covariates in meta-regression model; if none given, it is NULL\n    # model is normal (for now)\n    # var.model is homogeneous by default for now\n    # nChains is number of MCMC chains to run\n    # conv.limit is limit for BGR convergence\n    # niters is number of MCMC iterations to run\n    # nruns is number of MCMC iterations to save\n    # setsize is number of MCMC iterations after which convergence diagnostics should be checked\n    # alphaprior is prior for intercept as 3 element list (distribution, mean, precision)\n    # betaprior is prior for treatment effect as 3 element list (distribution, mean, precision)\n    # varprior is 2 element list of parameter and distribution upon which prior for variance is put \n    #    choices for parameter: precision(prec), variance(var), sd(sd)\n    #    choices for distribution: gamma(gamma), Wishart(wish), uniform(unif), halfnormal(hn)\n    # varprior.params is vector of parameters of variance distribution\n    # path is directory where data are stored\n    \n    nobs = length(Pain)\n    stopifnot(length(Pain)==nobs, length(Fatigue)==nobs, length(Drowsy)==nobs, length(Sleep)==nobs, length(Thinking)==nobs, length(Constipation)==nobs,length(Treat)==nobs)\n    stopifnot(length(varprior)==2)\n    stopifnot(length(alphaprior)==3, length(betaprior)==3)\n    stopifnot(length(varprior.params)==2)\n    \n    varprior = as.list(varprior)\n    alphaprior = as.list(alphaprior)\n    betaprior = as.list(betaprior)\n    \n    outnames = c(\"Pain\", \"Fatigue\", \"Drowsy\", \"Sleep\", \"Thinking\", \"Constipation\")\n    names(score.range) = outnames\n    \n    Pain.out = run.norm(Pain, Treat, Covs, model, var.model, nChains, conv.limit, niters, nruns, setsize, alphaprior, betaprior, varprior,varprior.params, path = \"\")\n    Fatigue.out = run.norm(Fatigue, Treat, Covs, model, var.model, nChains, conv.limit, niters, nruns, setsize, alphaprior, betaprior, varprior,varprior.params, path = \"\")\n    Drowsy.out = run.norm(Drowsy, Treat, Covs, model, var.model, nChains, conv.limit, niters, nruns, setsize, alphaprior, betaprior, varprior,varprior.params, path = \"\")\n    Sleep.out = run.norm(Sleep, Treat, Covs, model, var.model, nChains, conv.limit, niters, nruns, setsize, alphaprior, betaprior, varprior,varprior.params, path = \"\")\n    Thinking.out = run.norm(Thinking, Treat, Covs, model, var.model, nChains, conv.limit, niters, nruns, setsize, alphaprior, betaprior, varprior,varprior.params, path = \"\")\n    Constipation.out = run.norm(Constipation, Treat, Covs, model, var.model, nChains, conv.limit, niters, nruns, setsize, alphaprior, betaprior, varprior,varprior.params, path = \"\")\n    \n    Pain.beta = Pain.out[[\"beta\"]]\n    Fatigue.beta = Fatigue.out[[\"beta\"]]\n    Drowsy.beta = Drowsy.out[[\"beta\"]]\n    Sleep.beta = Pain.out[[\"beta\"]]\n    Thinking.beta = Thinking.out[[\"beta\"]]\n    Constipation.beta = Constipation.out[[\"beta\"]]\n    \n    Pain.beta.change = beta.change(Pain.beta, score.range[\"Pain\"])\n    Fatigue.beta.change = beta.change(Fatigue.beta, score.range[\"Fatigue\"])\n    Drowsy.beta.change = beta.change(Drowsy.beta, score.range[\"Drowsy\"])\n    Sleep.beta.change = beta.change(Sleep.beta, score.range[\"Sleep\"])\n    Thinking.beta.change = beta.change(Thinking.beta, score.range[\"Thinking\"])\n    Constipation.beta.change = beta.change(Constipation.beta, score.range[\"Constipation\"])\n    \n    beta.change.interval = round(rbind(Pain.beta.change[[1]], Fatigue.beta.change[[1]], Drowsy.beta.change[[1]], Sleep.beta.change[[1]], Thinking.beta.change[[1]], Constipation.beta.change[[1]]),3)\n    beta.change.probs = round(rbind(Pain.beta.change[[2]], Fatigue.beta.change[[2]], Drowsy.beta.change[[2]], Sleep.beta.change[[2]], Thinking.beta.change[[2]], Constipation.beta.change[[2]]),3)\n    dimnames(beta.change.interval) = list(outnames,c(\"P025\", \"Median\", \"P975\"))\n    dimnames(beta.change.probs) = list(outnames, paste(\"Proportion\",c(\"< 0.2\", \"-0.2 - 0\", \"0 - 0.2\", \"> 0.2\")))\n    \n    return(list(beta.change.interval, beta.change.probs))\n    \n  }",
    "created" : 1380852025253.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "818999046",
    "id" : "1A4A1871",
    "lastKnownWriteTime" : 1380852032,
    "path" : "~/workspace/Nof/R/wrap.norm.R",
    "project_path" : "R/wrap.norm.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}